---
experiment: "distance_gml"
name: "basic_distance_gml"
description: "Basic graph ml models, with distance graph construction"
task: "v1"

# Data
datasets:
-
  set: "train"
  val_size: 0.2
  path: "../data/train"
  batch_size: 32
  tfm: "fft"
  graph: 
    type: "distance"
    path: "../data/distances_3d.csv"

  edge_threshold: 1
  shuffle: True
  num_workers: 4

-
  set: "val"
  val_size: 0.2
  path: "../data/train"
  batch_size: 32
  tfm: "fft"
  graph: 
    type: "distance"
    path: "../data/distances_3d.csv"
  edge_threshold: 1
  shuffle: False
  num_workers: 4

-
  set: "test"
  path: "../data/test"
  batch_size: 32
  tfm: "fft"
  graph: 
    type: "distance"
    path: "../data/distances_3d.csv"
  edge_threshold: 1
  shuffle: False
  num_workers: 4

# Model
model:
  name : "CnnBase"
  n_epochs: 10
  optimizer: "SGD"
  use_scheduler: True
  learning_rate: 0.01
  criterion: "BCEWithLogitsLoss"
  config:
    layers:
      - out_channels_multiplier: 2
        pooling: "max"
      - out_channels_multiplier: 4
        pooling: "max"
      - out_channels_multiplier: 8
        pooling: "max"
      - out_channels_multiplier: 16
        pooling: "adaptiveavg"
    input_shape: 19
    output_shape: 1
    kernel_size: 5